{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Connect to server",
            "type": "go",
            "request": "launch",
            "mode": "remote",
            "remotePath": "${workspaceRoot}",
            "port": 2345,
            "host": "127.0.0.1",
            "program": "${workspaceRoot}",
            "env": {},
            "args": []
        },
        {
            "name": "Launch Function Discovery",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "program": "${workspaceFolder}/cmd/function-discovery",
            "args": [
                "--storage.type=file",
                "--storage.refreshrate=1s",
                "--secrets.type=file",
                "--secrets.refreshrate=1s",
                "--files.type=file",
                "--files.refreshrate=1s"
            ],
            "cwd": "/tmp/gloo790902659"
        },
        {
            "preLaunchTask": "build",
            "name": "Launch glue",
            "type": "go",
            "request": "launch",
            "mode": "exec",
            "program": "${workspaceFolder}/cmd/control-plane",
            "args": [
                "--copilot.address",
                "copilot.service.cf.internal:9000",
                "--copilot.client-cert",
                "/tmp/cert/server.cert",
                "--copilot.client-key",
                "/tmp/cert/server.key",
                "--copilot.server-ca",
                "/tmp/cert/server.cert",
                "--envoy.bind-adress",
                "0.0.0.0"
            ],
            "cwd": "${workspaceFolder}/hack/gen-config-yaml",
            "env": {
                "DEBUG": "1"
            }
        },
        {
            "preLaunchTask": "build-localgloo",
            "name": "Launch localgloo",
            "type": "go",
            "request": "launch",
            "mode": "exec",
            "program": "${workspaceFolder}/_output/localgloo",
            "args": [
                "--storage.type",
                "file",
                "--secrets.type",
                "file",
                "--files.type",
                "file",
                "--file.config.dir",
                "${workspaceFolder}/tmp/gloo/_gloo_config",
                "--file.files.dir",
                "${workspaceFolder}/tmp/gloo/_gloo_config/files",
                "--file.secret.dir",
                "${workspaceFolder}/tmp/gloo/_gloo_config/secrets"
            ],
            "cwd": "${workspaceFolder}/tmp/",
            "env": {
                "DEBUG": "1"
            }
        },
        {
            "preLaunchTask": "build-control-plane",
            "name": "Launch control-plane",
            "type": "go",
            "request": "launch",
            "mode": "exec",
            "program": "${workspaceFolder}/_output/control-plane",
            "args": [
                "--storage.type",
                "file",
                "--secrets.type",
                "file",
                "--files.type",
                "file",
                "--file.config.dir",
                "${workspaceFolder}/tmp/gloo/_gloo_config",
                "--file.files.dir",
                "${workspaceFolder}/tmp/gloo/_gloo_config/files",
                "--file.secret.dir",
                "${workspaceFolder}/tmp/gloo/_gloo_config/secrets"
            ],
            "cwd": "${workspaceFolder}/tmp/",
            "env": {
                "DEBUG": "1"
            }
        },
        {
            "preLaunchTask": "build-control-plane",
            "name": "Launch control-plane kube",
            "type": "go",
            "request": "launch",
            "mode": "exec",
            "program": "${workspaceFolder}/_output/control-plane",
            "args": [
                "--storage.type=kube",
                "--storage.refreshrate=1m",
                "--secrets.type=kube",
                "--secrets.refreshrate=1m",
                "--files.type=kube",
                "--files.refreshrate=1m",
                "--xds.port=8081",
                "--kube.namespace=gloo-system"
                    ],
            "cwd": "${workspaceFolder}/tmp/",
            "env": {
                "DEBUG": "1"
            }
        },
        {
            "name": "Launch localgloo for conncet",
            "type": "go",
            "request": "launch",
            "mode": "exec",
            "program": "${workspaceFolder}/_output/localgloo",
            "args": [
                "--storage.type",
                "file",
                "--secrets.type",
                "file",
                "--files.type",
                "file",
                "--file.config.dir",
                "${env:HOME}/go/src/github.com/solo-io/gloo-connect/getting-started/t/gloo/t/_gloo_config",
                "--file.files.dir",
                "${env:HOME}/go/src/github.com/solo-io/gloo-connect/getting-started/t/gloo/t/_gloo_config/files",
                "--file.secret.dir",
                "${env:HOME}/go/src/github.com/solo-io/gloo-connect/getting-started/t/gloo/t/_gloo_config/secrets"
            ],
            "cwd": "${env:HOME}/go/src/github.com/solo-io/gloo-connect/getting-started/t/gloo/tmp/",
            "env": {
                "DEBUG": "1"
            }
        },
        {
            "name": "Launch test package",
            "type": "go",
            "request": "launch",
            "mode": "test",
            "program": "${workspaceFolder}/internal/translator"
        },
        {
            "name": "(gdb) Launch Envoy",
            "type": "cppdbg",
            "request": "launch",
            "program": "${workspaceFolder}/build-envoy/bazel-bin/envoy",
            "args": [
                "-c",
                "${workspaceFolder}/tmp/envoy.json",
                "--v2-config-only",
                "--restart-epoch",
                "1"
            ],
            "stopAtEntry": false,
            "cwd": "${workspaceFolder}/tmp",
            "environment": [],
            "externalConsole": true,
            "MIMode": "gdb",
            "sourceFileMap": {
                "/proc/self/cwd/external/envoy/": "${workspaceFolder}/build-envoy/envoy",
                "external/envoy/": "${workspaceFolder}/build-envoy/envoy",
                "external/transformation_filter/": "${workspaceFolder}/pkg/plugins/common/transformation/envoy/",
            },
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                }
            ]
        },
        {
            "name": "(gdb) Launch Envoy for E2E",
            "type": "cppdbg",
            "request": "launch",
            "program": "${workspaceFolder}/build-envoy/bazel-bin/envoy",
            "args": [
                "-c",
                "${workspaceFolder}/tmp/envoy-e2e.yaml",
                "--v2-config-only",
                "--log-level",
                "debug"
            ],
            "stopAtEntry": false,
            "cwd": "${workspaceFolder}/tmp",
            "environment": [],
            "externalConsole": true,
            "MIMode": "gdb",
            "sourceFileMap": {
                "/proc/self/cwd/external/envoy/": "${workspaceFolder}/build-envoy/envoy",
                "external/envoy/": "${workspaceFolder}/build-envoy/envoy",
                "external/transformation_filter/": "${workspaceFolder}/pkg/plugins/common/transformation/envoy/",
            },
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                }
            ]
        },
        {
            "name": "Launch test e2e",
            "type": "go",
            "request": "launch",
            "mode": "test",
            "env": {
                "RUN_KUBE_TESTS":"1",
            },
            "program": "${workspaceFolder}/test/e2e"
        },
        {
            "name": "Launch gloo",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "env": {
                "START_STATS_SERVER":"true",
                // "KUBECONFIG": "/home/yuval/.kube/kind-config-test"
                // "KUBECONFIG": "${workspaceFolder}/tmp-kube-config.yaml"
            },
            "program": "${workspaceFolder}/projects/gloo/cmd",
//            "args": ["--namespace", "gateway-test-4571-1-3"]
            "args": ["--namespace", "gloo-system"]
        },
        {
            "name": "Launch gateway",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "env": {
                "START_STATS_SERVER":"true",
                // "KUBECONFIG": "/home/yuval/.kube/kind-config-test"
                // "KUBECONFIG": "${workspaceFolder}/tmp-kube-config.yaml"
            },
            "program": "${workspaceFolder}/projects/gateway/cmd",
            "args": ["--namespace", "gloo-system"]
        },
        {
            "name": "Launch discovery",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "env": {
                "START_STATS_SERVER":"true",
                // "KUBECONFIG": "/home/yuval/.kube/kind-config-test"
                "KUBECONFIG": "${workspaceFolder}/tmp-kube-config.yaml"
            },
            "program": "${workspaceFolder}/projects/discovery/cmd",
            "args": ["--namespace", "gloo-system"]
            //"args": ["--namespace", "test-yuval1"]
        },
        {
            "env": {
                "GO111MODULE":"on"
            },
            "name": "Launch file",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "program": "${file}"
        }
    ]
}